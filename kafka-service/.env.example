# Kafka Service Configuration
# Copy this file to .env and customize as needed

# ============================================================================
# Kafka Broker Configuration
# ============================================================================
KAFKA_BOOTSTRAP_SERVERS=localhost:9092
KAFKA_ENABLED=true

# Producer Configuration
KAFKA_ACKS=all  # all (safest), 1, or 0
KAFKA_RETRIES=3
KAFKA_IDEMPOTENCE=true  # Prevents duplicate messages
KAFKA_BATCH_SIZE=16384  # bytes
KAFKA_LINGER_MS=10  # milliseconds to wait before sending
KAFKA_BUFFER_MEMORY=33554432  # 32MB
KAFKA_MAX_REQUEST_SIZE=1048576  # 1MB
KAFKA_COMPRESSION_TYPE=snappy  # none, gzip, snappy, lz4, zstd

# Consumer Configuration
KAFKA_AUTO_OFFSET_RESET=earliest  # earliest, latest, none
KAFKA_ENABLE_AUTO_COMMIT=false  # Manual commit for reliability
KAFKA_MAX_POLL_RECORDS=500
KAFKA_SESSION_TIMEOUT_MS=30000
KAFKA_HEARTBEAT_INTERVAL_MS=3000
KAFKA_MAX_POLL_INTERVAL_MS=300000

# Consumer Group Configuration
KAFKA_GROUP_ID=vericrop-consumer-group
KAFKA_GROUP_INSTANCE_ID=vericrop-consumer-1  # For static membership

# ============================================================================
# Kafka Topics
# ============================================================================
KAFKA_TOPIC_BATCH_EVENTS=batch-events
KAFKA_TOPIC_QUALITY_ALERTS=quality-alerts
KAFKA_TOPIC_LOGISTICS_EVENTS=logistics-events
KAFKA_TOPIC_BLOCKCHAIN_EVENTS=blockchain-events
KAFKA_TOPIC_EVALUATION_REQUESTS=evaluation-requests
KAFKA_TOPIC_EVALUATION_RESULTS=evaluation-results
KAFKA_TOPIC_SHIPMENT_RECORDS=shipment-records

# Topic Configuration (for auto-creation or admin)
KAFKA_TOPIC_PARTITIONS=3
KAFKA_TOPIC_REPLICATION_FACTOR=1  # Use 3 in production with multiple brokers

# ============================================================================
# Security Configuration (TLS/SSL)
# ============================================================================
# Uncomment and configure for TLS encryption

# KAFKA_SECURITY_PROTOCOL=SSL  # PLAINTEXT, SSL, SASL_PLAINTEXT, SASL_SSL
# KAFKA_SSL_TRUSTSTORE_LOCATION=/path/to/truststore.jks
# KAFKA_SSL_TRUSTSTORE_PASSWORD=<truststore-password>
# KAFKA_SSL_KEYSTORE_LOCATION=/path/to/keystore.jks
# KAFKA_SSL_KEYSTORE_PASSWORD=<keystore-password>
# KAFKA_SSL_KEY_PASSWORD=<key-password>
# KAFKA_SSL_ENDPOINT_IDENTIFICATION_ALGORITHM=https  # Set to empty string to disable hostname verification

# ============================================================================
# Security Configuration (SASL)
# ============================================================================
# Uncomment and configure for SASL authentication

# KAFKA_SASL_MECHANISM=PLAIN  # PLAIN, SCRAM-SHA-256, SCRAM-SHA-512, GSSAPI
# KAFKA_SASL_JAAS_CONFIG=org.apache.kafka.common.security.plain.PlainLoginModule required username="<username>" password="<password>";

# For SCRAM:
# KAFKA_SASL_MECHANISM=SCRAM-SHA-512
# KAFKA_SASL_JAAS_CONFIG=org.apache.kafka.common.security.scram.ScramLoginModule required username="<username>" password="<password>";

# ============================================================================
# Schema Registry Configuration (Optional)
# ============================================================================
# Uncomment if using Confluent Schema Registry

# SCHEMA_REGISTRY_URL=http://localhost:8081
# SCHEMA_REGISTRY_USERNAME=<username>
# SCHEMA_REGISTRY_PASSWORD=<password>
# SCHEMA_REGISTRY_BASIC_AUTH_CREDENTIALS_SOURCE=USER_INFO
# SCHEMA_REGISTRY_USER_INFO=<username>:<password>

# ============================================================================
# Monitoring and Observability
# ============================================================================
KAFKA_JMX_PORT=9999  # For JMX metrics collection
KAFKA_METRICS_RECORDING_LEVEL=INFO  # DEBUG, INFO, WARN, ERROR
ENABLE_METRICS=true

# Prometheus Metrics
PROMETHEUS_PORT=9090
PROMETHEUS_PATH=/metrics

# ============================================================================
# Retry and Circuit Breaker Configuration (Resilience4j)
# ============================================================================
RETRY_MAX_ATTEMPTS=3
RETRY_WAIT_DURATION=1000  # milliseconds
CIRCUIT_BREAKER_FAILURE_RATE_THRESHOLD=50  # percentage
CIRCUIT_BREAKER_WAIT_DURATION_IN_OPEN_STATE=60000  # milliseconds
CIRCUIT_BREAKER_SLIDING_WINDOW_SIZE=10

# ============================================================================
# Application Configuration
# ============================================================================
SERVICE_NAME=kafka-service
SERVICE_VERSION=1.0.0
ENVIRONMENT=development  # development, staging, production
LOG_LEVEL=INFO
LOG_FORMAT=json  # text or json
