<?xml version="1.0" encoding="UTF-8"?>

<?import javafx.geometry.Insets?>
<?import javafx.scene.control.*?>
<?import javafx.scene.layout.*?>
<?import javafx.scene.text.*?>

<VBox xmlns="http://javafx.com/javafx/11.0.1" xmlns:fx="http://javafx.com/fxml/1"
      fx:controller="org.vericrop.gui.ConsumerController"
      styleClass="main-container" spacing="20"
      stylesheets="@../css/styles.css">

    <padding>
        <Insets top="20" right="20" bottom="20" left="20"/>
    </padding>

    <!-- Header -->
    <HBox spacing="20" alignment="CENTER_LEFT">
        <VBox spacing="2">
            <Label text="VERICROP - PRODUCT VERIFICATION" styleClass="title-label"/>
            <Label text="Consumer Portal - Verify Product Authenticity" style="-fx-text-fill: #666; -fx-font-size: 12px;"/>
        </VBox>
        <Region HBox.hgrow="ALWAYS"/>

        <!-- Navigation Buttons -->
        <HBox spacing="10" alignment="CENTER">
            <Button fx:id="backToProducerButton" text="ðŸ  Producer"
                    style="-fx-background-color: #2E8B57; -fx-text-fill: white; -fx-font-weight: bold; -fx-background-radius: 8; -fx-padding: 8 12;"
                    onAction="#handleBackToProducer"/>
            <Button fx:id="logisticsButton" text="ðŸšš Logistics"
                    style="-fx-background-color: #F59E0B; -fx-text-fill: white; -fx-font-weight: bold; -fx-background-radius: 8; -fx-padding: 8 12;"
                    onAction="#handleShowLogistics"/>
            <Button fx:id="messagesButton" text="ðŸ’¬ Messages"
                    style="-fx-background-color: #8B5CF6; -fx-text-fill: white; -fx-font-weight: bold; -fx-background-radius: 8; -fx-padding: 8 12;"
                    onAction="#handleShowMessages"/>
        </HBox>

        <Button text="Scan QR" styleClass="primary-button" onAction="#handleScanQR"/>
        <Button text="Verify Another" styleClass="success-button" onAction="#handleVerifyAnother"/>
        <Button fx:id="logoutButton" text="ðŸšª Logout"
                style="-fx-background-color: #DC2626; -fx-text-fill: white; -fx-font-weight: bold; -fx-background-radius: 8; -fx-padding: 8 12;"
                onAction="#handleLogout"/>
    </HBox>

    <!-- Navigation Tabs -->
    <TabPane styleClass="tab-pane">
        <tabs>
            <Tab text="Scan QR">
                <VBox spacing="20" alignment="CENTER">
                    <VBox styleClass="verification-card" spacing="15" alignment="CENTER" prefWidth="500">
                        <Label text="âœ… VERIFIED: Genuine Product" styleClass="verification-success"/>
                        <Label text="ðŸŽ Summer Apples - A2386" styleClass="subtitle-label"/>

                        <!-- QR Scanner Placeholder -->
                        <Pane style="-fx-background-color: #f1f5f9; -fx-border-radius: 8; -fx-pref-height: 200; -fx-pref-width: 200;"
                        >
                            <Label text="QR Scanner\nPlaceholder"
                                   style="-fx-text-alignment: center; -fx-text-fill: #64748b;"/>
                        </Pane>

                        <TextArea promptText="Or enter Batch ID manually..."
                                  styleClass="text-field" prefWidth="300"/>
                        <Button text="Verify Product" styleClass="success-button" onAction="#handleVerifyProduct"/>
                    </VBox>
                </VBox>
            </Tab>

            <Tab text="Enter Batch ID">
                <VBox spacing="20" alignment="CENTER">
                    <VBox styleClass="dashboard-card" spacing="15" alignment="CENTER" prefWidth="400">
                        <Label text="Manual Verification" styleClass="subtitle-label"/>
                        <TextField fx:id="batchIdField" promptText="Enter Batch ID" styleClass="text-field" prefWidth="300"/>
                        <Button text="Verify" styleClass="primary-button" onAction="#handleManualVerify" defaultButton="true"/>
                    </VBox>
                </VBox>
            </Tab>

            <Tab text="Verification History">
                <VBox spacing="15">
                    <ListView fx:id="verificationHistoryList" styleClass="modern-list" VBox.vgrow="ALWAYS"/>
                    <HBox spacing="10">
                        <Button text="Clear History" styleClass="primary-button" onAction="#handleClearHistory"/>
                        <Button text="Export History" styleClass="success-button" onAction="#handleExportHistory"/>
                    </HBox>
                </VBox>
            </Tab>
        </tabs>
    </TabPane>

    <!-- Product Journey -->
    <VBox styleClass="dashboard-card" spacing="15">
        <Label text="ðŸ“‹ Product Journey" styleClass="subtitle-label"/>
        <VBox fx:id="productJourneyContainer" style="-fx-border-color: #e2e8f0; -fx-border-radius: 8; -fx-padding: 15; -fx-spacing: 12;">
            <HBox spacing="15" alignment="CENTER_LEFT">
                <Label text="â³" style="-fx-font-size: 16;"/>
                <VBox>
                    <Label text="Waiting for delivery..." style="-fx-font-weight: bold; -fx-text-fill: #64748b;"/>
                    <Label text="Start a simulation or verify a batch to see journey details" style="-fx-text-fill: #94a3b8;"/>
                </VBox>
            </HBox>
        </VBox>
    </VBox>

    <!-- Quality Metrics -->
    <VBox styleClass="dashboard-card" spacing="15">
        <Label text="ðŸŽ¯ Quality Metrics" styleClass="subtitle-label"/>
        <HBox fx:id="qualityMetricsContainer" spacing="20" alignment="CENTER">
            <VBox styleClass="metric-card" spacing="5" alignment="CENTER" prefWidth="120">
                <Label fx:id="finalQualityLabel" text="--%" styleClass="metric-value" style="-fx-text-fill: #10b981;"/>
                <Label text="Final Quality" styleClass="metric-label"/>
            </VBox>
            <VBox styleClass="metric-card" spacing="5" alignment="CENTER" prefWidth="120">
                <Label fx:id="deliveryStatusLabel" text="N/A" styleClass="metric-value" style="-fx-text-fill: #3b82f6;"/>
                <Label text="Delivery Status" styleClass="metric-label"/>
            </VBox>
            <VBox styleClass="metric-card" spacing="5" alignment="CENTER" prefWidth="120">
                <Label fx:id="deliveryTimeLabel" text="--" styleClass="metric-value" style="-fx-text-fill: #f59e0b;"/>
                <Label text="Transit Time" styleClass="metric-label"/>
            </VBox>
        </HBox>
    </VBox>

    <!-- Action Buttons -->
    <HBox spacing="15" alignment="CENTER">
        <Button text="ðŸ“± Share Verification" styleClass="primary-button" onAction="#handleShareVerification"/>
        <Button text="ðŸ”„ Verify Another Product" styleClass="success-button" onAction="#handleVerifyAnother"/>
    </HBox>

</VBox>