<?xml version="1.0" encoding="UTF-8"?>

<?import javafx.geometry.Insets?>
<?import javafx.scene.control.*?>
<?import javafx.scene.layout.*?>
<?import javafx.scene.chart.*?>
<?import javafx.scene.text.*?>
<?import javafx.scene.image.ImageView?>

<VBox xmlns="http://javafx.com/javafx/11.0.1" xmlns:fx="http://javafx.com/fxml/1"
      fx:controller="org.vericrop.gui.LogisticsController"
      styleClass="main-container" spacing="20"
      stylesheets="@../css/styles.css">

    <padding>
        <Insets top="20" right="20" bottom="20" left="20"/>
    </padding>

    <!-- Header -->
    <HBox spacing="20" alignment="CENTER_LEFT">
        <VBox spacing="2">
            <Label text="LOGISTICS MONITORING - LIVE DELIVERY TRACKING" styleClass="title-label"/>
            <Label text="Real-time Shipment Tracking And Monitoring" style="-fx-text-fill: #666; -fx-font-size: 12px;"/>
        </VBox>
        <Region HBox.hgrow="ALWAYS"/>

        <!-- Navigation Buttons -->
        <HBox spacing="10" alignment="CENTER">
            <Button fx:id="backToProducerButton" text="ðŸ  Producer"
                    style="-fx-background-color: #2E8B57; -fx-text-fill: white; -fx-font-weight: bold; -fx-background-radius: 8; -fx-padding: 8 12;"
                    onAction="#handleBackToProducer"/>
            <Button fx:id="consumerButton" text="ðŸ‘¥ Consumer"
                    style="-fx-background-color: #10B981; -fx-text-fill: white; -fx-font-weight: bold; -fx-background-radius: 8; -fx-padding: 8 12;"
                    onAction="#handleShowConsumer"/>
            <Button fx:id="messagesButton" text="ðŸ’¬ Messages"
                    style="-fx-background-color: #8B5CF6; -fx-text-fill: white; -fx-font-weight: bold; -fx-background-radius: 8; -fx-padding: 8 12;"
                    onAction="#handleShowMessages"/>
            <Button fx:id="contactsButton" text="ðŸ‘¥ Contacts"
                    style="-fx-background-color: #3B82F6; -fx-text-fill: white; -fx-font-weight: bold; -fx-background-radius: 8; -fx-padding: 8 12;"
                    onAction="#handleShowContacts"/>
        </HBox>

        <Button text="Refresh" styleClass="primary-button" onAction="#handleRefresh"/>
        <Button fx:id="logoutButton" text="ðŸšª Logout"
                style="-fx-background-color: #DC2626; -fx-text-fill: white; -fx-font-weight: bold; -fx-background-radius: 8; -fx-padding: 8 12;"
                onAction="#handleLogout"/>
    </HBox>

    <!-- Navigation Tabs -->
    <TabPane styleClass="tab-pane">
        <tabs>
            <Tab text="Dashboard">
                <VBox spacing="15">
                    <!-- Batch Info Card -->
                    <HBox styleClass="dashboard-card" spacing="20">
                        <VBox spacing="8">
                            <Label text="Farm: Sunny Valley â†’ Warehouse: Metro Fresh" styleClass="subtitle-label"/>
                            <HBox spacing="20" alignment="CENTER_LEFT">
                                <Label text="Status: LIVE TRACKING ACTIVE" styleClass="status-label" style="-fx-text-fill: #10b981; -fx-font-weight: bold;"/>
                                <Label text="Active Simulations: " styleClass="status-label" style="-fx-text-fill: #3b82f6;"/>
                            </HBox>
                        </VBox>
                    </HBox>

                    <!-- Main Content -->
                    <HBox spacing="20">
                        <!-- Left Column -->
                        <VBox spacing="15" styleClass="left-panel" prefWidth="400">
                            <Label text="ðŸ—ºï¸ Live Route Tracking" styleClass="subtitle-label"/>
                            <Pane fx:id="mapContainer" style="-fx-background-color: #f8f9fa; -fx-border-color: #e9ecef; -fx-border-radius: 8;"
                                  prefHeight="200" prefWidth="350">
                                <Label text="Loading real-time delivery tracking..."
                                       style="-fx-text-alignment: center; -fx-text-fill: #64748b; -fx-alignment: center;"/>
                            </Pane>

                            <Label text="Timeline" styleClass="subtitle-label"/>
                            <VBox fx:id="timelineContainer" styleClass="timeline-container" spacing="10">
                                <HBox styleClass="timeline-item" spacing="10" alignment="CENTER_LEFT">
                                    <Label text="â—" style="-fx-text-fill: #10b981; -fx-font-weight: bold;"/>
                                    <VBox>
                                        <Label text="Created" style="-fx-font-weight: bold;"/>
                                        <Label text="Batch created at Sunny Valley Farm"/>
                                    </VBox>
                                </HBox>
                                <HBox styleClass="timeline-item" spacing="10" alignment="CENTER_LEFT">
                                    <Label text="â—" style="-fx-text-fill: #3b82f6; -fx-font-weight: bold;"/>
                                    <VBox>
                                        <Label text="In Transit" style="-fx-font-weight: bold;"/>
                                        <Label text="Real-time GPS tracking active"/>
                                    </VBox>
                                </HBox>
                                <HBox styleClass="timeline-item" spacing="10" alignment="CENTER_LEFT">
                                    <Label text="â—‹" style="-fx-text-fill: #64748b;"/>
                                    <VBox>
                                        <Label text="At Warehouse" style="-fx-text-fill: #64748b;"/>
                                        <Label text="ETA: Calculated in real-time"/>
                                    </VBox>
                                </HBox>
                            </VBox>
                        </VBox>

                        <!-- Right Column -->
                        <VBox spacing="15" styleClass="right-panel" VBox.vgrow="ALWAYS">
                            <Label text="ðŸ“Š Environmental Data" styleClass="subtitle-label"/>

                            <!-- Temperature Chart -->
                            <VBox spacing="10">
                                <Label text="Temperature History"/>
                                <LineChart fx:id="temperatureChart" prefHeight="150">
                                    <xAxis>
                                        <NumberAxis fx:id="temperatureTimeAxis" label="Time (s)" lowerBound="0" upperBound="60" tickUnit="10"/>
                                    </xAxis>
                                    <yAxis>
                                        <NumberAxis label="Â°C" lowerBound="0" upperBound="10" tickUnit="2"/>
                                    </yAxis>
                                </LineChart>
                            </VBox>

                            <!-- Alerts Panel -->
                            <VBox styleClass="alert-panel success" spacing="8">
                                <Label text="ðŸš¨ Live Alerts Panel" style="-fx-font-weight: bold;"/>
                                <Label text="âœ“ Real-time monitoring active"/>
                                <Label text="âœ“ Environmental sensors online"/>
                                <Label text="âœ“ GPS tracking synchronized"/>
                            </VBox>

                            <!-- Quality Tracking -->
                            <HBox spacing="15" alignment="CENTER_LEFT">
                                <Label text="ðŸ“‹ Quality Tracking:" styleClass="status-label"/>
                                <Label text="Real-time monitoring active"
                                       style="-fx-text-fill: #10b981; -fx-font-weight: bold;"/>
                            </HBox>
                        </VBox>
                    </HBox>
                </VBox>
            </Tab>

            <Tab text="Active Shipments">
                <VBox spacing="15">
                    <TableView fx:id="shipmentsTable" styleClass="table-view" VBox.vgrow="ALWAYS">
                        <columns>
                            <TableColumn text="Batch ID" prefWidth="120"/>
                            <TableColumn text="Status" prefWidth="100"/>
                            <TableColumn text="Current Location" prefWidth="200"/>
                            <TableColumn text="Temperature" prefWidth="80"/>
                            <TableColumn text="Humidity" prefWidth="80"/>
                            <TableColumn text="ETA" prefWidth="120"/>
                            <TableColumn text="Vehicle" prefWidth="100"/>
                        </columns>
                    </TableView>
                    <HBox spacing="10">
                        <Button text="Refresh Data" styleClass="primary-button" onAction="#handleRefresh"/>
                        <Label text="ðŸ”„ Real-time updates every 2 seconds" style="-fx-text-fill: #666; -fx-font-size: 11px;"/>
                    </HBox>
                </VBox>
            </Tab>

            <Tab text="Alerts">
                <VBox spacing="15">
                    <ListView fx:id="alertsList" styleClass="modern-list" VBox.vgrow="ALWAYS"/>
                    <HBox spacing="10">
                        <Button text="Acknowledge All" styleClass="primary-button" onAction="#handleAcknowledgeAlerts"/>
                        <Button text="Simulate Alert" styleClass="warning-button" onAction="#handleSimulateAlert"/>
                        <Label text="Live alerts from delivery simulator" style="-fx-text-fill: #666; -fx-font-size: 11px;"/>
                    </HBox>
                </VBox>
            </Tab>

            <Tab text="Reports">
                <VBox spacing="15">
                    <HBox spacing="10" alignment="CENTER_LEFT">
                        <ComboBox fx:id="reportTypeCombo" promptText="Select Report Type" prefWidth="180"/>
                        <DatePicker fx:id="startDatePicker" promptText="Start Date"/>
                        <DatePicker fx:id="endDatePicker" promptText="End Date"/>
                        <Label text="Format:"/>
                        <ComboBox fx:id="exportFormatCombo" prefWidth="80"/>
                        <Button text="Generate Report" styleClass="primary-button" onAction="#handleGenerateReport"/>
                        <Button text="Export Report" styleClass="success-button" onAction="#handleExportReport"/>
                    </HBox>
                    <TextArea fx:id="reportArea" styleClass="text-area" VBox.vgrow="ALWAYS"/>
                </VBox>
            </Tab>
        </tabs>
    </TabPane>

</VBox>